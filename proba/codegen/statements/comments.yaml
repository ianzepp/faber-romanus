# Comment preservation through parse -> codegen pipeline
#
# Comments are attached to AST nodes during parsing and emitted during codegen.
# - Leading comments appear before the statement
# - Trailing comments appear on the same line after the statement
#
# Target syntax:
#   ts/rs/cpp: // line, /* block */
#   py: # line, """ block """
#   zig: // line only (no block comments)

# =============================================================================
# Leading Line Comments
# =============================================================================

# Single leading comment
- name: leading line comment
  faber: |
      // This is a comment
      fixum x = 5
  expect:
      ts:
          - '// This is a comment'
          - 'const x = 5'
      py:
          - '# This is a comment'
          - 'x = 5'
      rs:
          - '// This is a comment'
          - 'let x = 5'
      cpp:
          - '// This is a comment'
          - 'const auto x = 5'
      zig:
          # Zig prefixes module-level constants with m_
          - '// This is a comment'
          - 'const m_x = 5'
      fab:
          - '// This is a comment'
          - 'fixum x = 5'

# Multiple leading comments
- name: multiple leading comments
  faber: |
      // First comment
      // Second comment
      fixum y = 10
  expect:
      ts:
          - '// First comment'
          - '// Second comment'
          - 'const y = 10'
      py:
          - '# First comment'
          - '# Second comment'
          - 'y = 10'
      fab:
          - '// First comment'
          - '// Second comment'
          - 'fixum y = 10'

# =============================================================================
# Trailing Comments
# =============================================================================

# Trailing comment on same line
- name: trailing line comment
  faber: 'fixum z = 42  // magic number'
  expect:
      ts:
          - 'const z = 42; // magic number'
      py:
          - 'z = 42 # magic number'
      rs:
          - 'let z = 42; // magic number'
      cpp:
          - 'const auto z = 42; // magic number'
      zig:
          # Zig prefixes module-level constants with m_
          - 'const m_z = 42; // magic number'
      fab:
          - 'fixum z = 42 // magic number'

# =============================================================================
# Block Comments
# =============================================================================

# Block comment
- name: block comment
  faber: |
      /* This is a block comment */
      fixum a = 1
  expect:
      ts:
          - '/* This is a block comment */'
          - 'const a = 1'
      py:
          - '"""'
          - 'This is a block comment'
          - '"""'
      rs:
          - '/* This is a block comment */'
      cpp:
          - '/* This is a block comment */'
      zig:
          - '// This is a block comment'
      fab:
          - '/* This is a block comment */'
          - 'fixum a = 1'

# =============================================================================
# Doc Comments
# =============================================================================

# Documentation comment
- name: doc comment on function
  faber: |
      /** Greets the user */
      functio greet() {
          scribe "Hello"
      }
  expect:
      ts:
          contains:
              - '/* * Greets the user */'
              - 'function greet()'
      py:
          contains:
              - '"""'
              - 'Greets the user'
              - 'def greet():'
      fab:
          - '/** Greets the user */'
          - 'functio greet()'

# =============================================================================
# Comments in Control Structures
# =============================================================================

# Comment before if statement
- name: comment before if
  faber: |
      // Check condition
      si verum {
          scribe "yes"
      }
  expect:
      ts:
          - '// Check condition'
          - 'if (true)'
      py:
          - '# Check condition'
          - 'if True:'
      fab:
          - '// Check condition'
          - 'si verum'
