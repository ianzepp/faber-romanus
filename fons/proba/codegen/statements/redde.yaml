# Return statements - redde
# Maps Faber return syntax to target-language return statements
#
# Syntax:
#   redde expression  -- returns the expression value
#   redde             -- returns without a value (void return)

# =============================================================================
# Basic Return
# =============================================================================

# Return with expression
- name: return with value
  source: 'redde 42'
  expect:
      ts:
          - 'return 42;'
      py:
          - 'return 42'
      rs:
          - 'return 42;'
      cpp:
          - 'return 42;'
      zig:
          - 'return 42;'
      fab:
          - 'redde 42'

# Return with string
- name: return with string
  source: 'redde "hello"'
  expect:
      ts:
          - 'return "hello";'
      py:
          - 'return "hello"'
      rs:
          - 'return "hello";'
      cpp:
          - 'return "hello";'
      zig:
          - 'return "hello";'
      fab:
          - 'redde "hello"'

# Return with variable
- name: return with identifier
  source: 'redde result'
  expect:
      ts:
          - 'return result;'
      py:
          - 'return result'
      rs:
          - 'return result;'
      cpp:
          - 'return result;'
      zig:
          - 'return result;'
      fab:
          - 'redde result'

# Return with expression
- name: return with binary expression
  source: 'redde x + y'
  expect:
      ts:
          - 'return (x + y);'
      py:
          - 'return (x + y)'
      rs:
          - 'return (x + y);'
      cpp:
          - 'return (x + y);'
      zig:
          - 'return (x + y);'
      fab:
          - 'redde x + y'

# Void return (no value)
- name: void return
  source: 'redde'
  expect:
      ts:
          - 'return;'
      py:
          - 'return'
      rs:
          - 'return;'
      cpp:
          - 'return;'
      zig:
          - 'return;'
      fab:
          - 'redde'

# =============================================================================
# Edge Cases
# =============================================================================

# Return with object literal
- name: return with object literal
  source: 'redde { success: verum, data: result }'
  expect:
      ts:
          - 'return { success: true, data: result };'
      py:
          - 'return {"success": True, "data": result}'
      fab:
          - 'redde { success: verum, data: result }'

# Return with array literal
- name: return with array literal
  source: 'redde [a, b, c]'
  expect:
      ts:
          - 'return [a, b, c];'
      py:
          - 'return [a, b, c]'
      fab:
          - 'redde [a, b, c]'

# Return with lambda
- name: return with lambda
  source: 'redde pro x: x * 2'
  expect:
      ts:
          - 'return (x) => (x * 2);'
      py:
          - 'return lambda x: (x * 2)'
      fab:
          - 'redde pro x: x * 2'

# Return with complex expression
- name: return with complex expression
  source: 'redde a + b * c - d / e'
  expect:
      ts:
          - 'return ((a + (b * c)) - (d / e));'
      py:
          - 'return ((a + (b * c)) - (d / e))'
      fab:
          - 'redde a + b * c - d / e'

# Return with call chain
- name: return with call chain
  source: 'redde items.filter(fn).map(fn2).first'
  expect:
      ts:
          - 'return items.filter(fn).map(fn2).first;'
      py:
          - 'return items.filter(fn).map(fn2).first'
      fab:
          - 'redde items.filter(fn).map(fn2).first'

# Return with template literal
- name: return with template literal
  source: 'redde `Hello ${name}!`'
  expect:
      ts:
          - 'return `Hello ${name}!`;'
      py:
          - 'return f"Hello {name}!"'
      fab:
          - 'redde `Hello ${name}!`'

# Return with member access
- name: return with member access
  source: 'redde obj.nested.value'
  expect:
      ts:
          - 'return obj.nested.value;'
      py:
          - 'return obj.nested.value'
      fab:
          - 'redde obj.nested.value'

# Return from nested block
- name: return from nested block
  source: |
      si x > 0 fac
        redde x
      fine
  expect:
      ts:
          - 'if ((x > 0)) {'
          - 'return x;'
          - '}'
      py:
          - 'if (x > 0):'
          - 'return x'
      fab:
          - 'si x > 0 fac'
          - 'redde x'
          - 'fine'
