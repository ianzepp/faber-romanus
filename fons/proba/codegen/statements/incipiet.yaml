# Incipiet - Program entry point (async)
# Generates async main() or equivalent for each target

- name: basic incipiet with body
  source: |
      incipiet {
        scribe "Hello"
      }
  expect:
      ts:
          - '(async () => {'
          - 'console.log("Hello");'
          - '})();'
      py:
          - 'async def main():'
          - 'print("Hello")'
          - 'asyncio.run(main())'
      rs:
          - '#[tokio::main]'
          - 'async fn main() {'
          - 'println!("{}"'
          - '"Hello"'
      cpp:
          - 'int main() {'
          - 'std::print'
          - '"Hello"'
      fab:
          - 'incipiet {'
          - 'scribe "Hello"'
  skip: [zig]

- name: incipiet ergo cura arena
  source: |
      incipiet ergo cura arena {
        scribe "Hello"
      }
  expect:
      ts:
          - '(async () => {'
          - 'console.log("Hello");'
          - '})();'
      py:
          - 'async def main():'
          - 'print("Hello")'
          - 'asyncio.run(main())'
      rs:
          - '#[tokio::main]'
          - 'async fn main() {'
          - 'println!("{}"'
          - '"Hello"'
      cpp:
          - 'int main() {'
          - 'std::print'
          - '"Hello"'
      fab:
          - 'incipiet ergo cura arena {'
          - 'scribe "Hello"'
  skip: [zig]

- name: incipiet with await
  source: |
      incipiet {
        fixum data = cede fetch()
        scribe data
      }
  expect:
      ts:
          - '(async () => {'
          - 'const data = await fetch();'
          - 'console.log(data);'
          - '})();'
      py:
          - 'async def main():'
          - 'data = await fetch()'
          - 'print(data)'
          - 'asyncio.run(main())'
      rs:
          - '#[tokio::main]'
          - 'async fn main() {'
          - 'let data = fetch().await;'
      cpp:
          - 'int main() {'
          - 'std::async'
          - 'fetch()'
      fab:
          - 'incipiet {'
          - 'fixum data = cede fetch()'
          - 'scribe data'
  skip: [zig]
